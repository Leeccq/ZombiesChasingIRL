<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>ZombiesChasingIRL</title>

  <!-- Leaflet CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />

  <style>
	#map {
	  height: 100vh;
	  width: 100%;
	}
  </style>
</head>
<body>

  <div id="map"></div>

  <!-- Leaflet JS -->
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

  <script>
	// Map initialization
	const map = L.map('map').setView([0, 0], 2);

	// OpenStreetMap Tiles
	L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
	  maxZoom: 19,
	  attribution: '© OpenStreetMap'
	}).addTo(map);

	let marker = null;

	// Fonction called after every update of player position
	function updatePosition(pos) {
	  const lat = pos.coords.latitude;
	  const lon = pos.coords.longitude;

	  // Center the map for the first time
	  map.setView([lat, lon], 16);

	  if (!marker) {
		// Create a marker for player's position
		marker = L.marker([lat, lon]).addTo(map)
		  .bindPopup("Position actuelle")
		  .openPopup();
	  } else {
		// Else move the existing marker to current player's position
		marker.setLatLng([lat, lon]);
	  }
	}

	// Continious GPS tracking of player's position
	if (navigator.geolocation) {
	  navigator.geolocation.watchPosition(
		updatePosition,
		(err) => alert("Impossible de récupérer la position."),
		{
		  enableHighAccuracy: true, // better accuracy
		  maximumAge: 0,
		  timeout: 5000
		}
	  );
	} else {
	  alert("La géolocalisation n'est pas supportée.");
	}
  </script>

</body>
</html>
